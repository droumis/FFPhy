function [tm, novelDay]= allTimes(timeid, selectid)
%function tm= auxGetTimes(timeid, selectid)
% passes
% occ minocc
% acc minacc
% first
% end
%        nsec= 5;
nsec= 1;
switch timeid
case {'minocc'}
    nsec= 60;
    timeid= 'occ';
case {'minacc'}
    nsec= 60;
    timeid= 'acc';
end
load(['/home/chengs/theta/work/analist-' selectid])
tm= {};
nC= length(analist.rat);
novelDay= nan*zeros(nC,1);
oldrat= ''; oldd= -1;
oldratfirst= ''; 
if strfind(timeid, 'first'); pf= allPlaceFields(selectid); end
for iC= 1:nC
    % set up data
    rat= analist.rat{iC};
    num= analist.cellnum(iC,:); d=num(1); e=num(2); tet=num(3); c=num(4);
    % load real stats
    if ~strcmp(rat, oldrat)
        load(['/data11/chengs/' rat '/data2/PassOccTimes.mat']);
        load(sprintf('/data11/chengs/%s/data2/select-%s.mat', rat, selectid));
        oldrat= rat;
        armdone= nan*zeros(8,2);
        daycount= zeros(8,1);
%        keyboard
    end
    pot= PassOccTimes{d}{e};
    t= pot.stimes;
    traj= analist.traj(iC);

    if isfield(pot,'novelArm') & length(pot.novelArm)> 0 ...
%        & isfield(pot,'novelTraj') & sum(ismember(traj, pot.novelTraj))> 0 ...

        for j=1:length(pot.novelArm)
            iarm= pot.novelArm(j);
            if sum(armdone(iarm,:) == [d e])~= 2
                armdone(iarm,:) = [d e];
                daycount(iarm)= daycount(iarm)+1;
            end
            novelDay(iC)= daycount(iarm);
        end
    end

    switch timeid
    case 'passes'
        tm{iC}= pot.outArmEnd{traj+1};
    case {'occ'}
        occ= pot.outArmOcc{traj+1};
    case {'acc'}
        occ= pot.outArmAcc{traj+1};
    case {'firstpass', 'firstocc'}
        if ~strcmp(oldratfirst, rat)  | oldd ~= d
            oldratfirst= rat; oldd= d;
            load(sprintf('/data11/chengs/%s/data2/spikedata%.2d.mat', rat, d));
%            load(sprintf('/data11/chengs/%s/data2/behavdata%.2d.mat', rat, d));
        end
        nsel= getSelectId([d,e,tet,c], select);
        spt= spikedata{d}{e}{tet}{c}.time;
%        spind= spikedata{d}{e}{tet}{c}.index;
%        spx= behavdata{d}{e}.linpos(spind);
        spx= spikedata{d}{e}{tet}{c}.linpos;
        first= spt(min(find(spx > pf(iC,1) & spx < pf(iC,2))));
        if isempty(first);
            warning('No spikes found in PLACEFIELD!!!');
            first= t(end);
        end
    case 'end'
        tm{iC}= pot.outArmEnd{traj+1}(end);
    otherwise
        error('unknown time selection');
    end

    switch timeid
    case {'firstpass'}
        % first, and then passes
        pt= pot.outArmEnd{traj+1};
        tm{iC}= pt(find(first < pt));
    case {'firstocc'}
        % first, and then occupancy
        ind= find(first < t);
        occ= pot.outArmAcc{traj+1}(ind);
    end

    switch timeid
    case {'occ', 'acc', 'firstocc'}
        maxmin= floor(max(occ)/nsec);
        tm{iC}= nan*zeros(1,maxmin);
        for im=1:maxmin
            ind= min(find(nsec*im < occ));
            if(abs(occ(ind)-nsec*im) > 5) 
%                warning('could not find close time');
            else
                tm{iC}(im)= t(ind);
            end
        end
    end

%    keyboard

end  % for iC

novelDay(novelDay==0)= nan;
%keyboard
