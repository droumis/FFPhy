<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of lfplot</title>
  <meta name="keywords" content="lfplot">
  <meta name="description" content="Plot (for one or two dimensions) a locfit() fit.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">chronux_1_50</a> &gt; <a href="index.html">locfit</a> &gt; lfplot.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for chronux_1_50\locfit&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>lfplot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>Plot (for one or two dimensions) a locfit() fit.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function lfplot(varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> Plot (for one or two dimensions) a locfit() fit.

 Usage:
   fit = locfit(x,y);
   lfplot(fit);

 Plot the fitted smooth curve, and add a scatterplot of the data.

 Required argument:
   fit  (produced by locfit()).

 Optional arguments:
   'nodata'  - don't add data to plot.
   'contour' - for 2-d predictors, use contour instead of surf.
   'direct'  - fit directly, instead of using interpolation
               (see the predict() function).

 To add confidence bands, use the lfband() function.

 Author: Catherine Loader.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="invlink.html" class="code" title="function y0 = invlink(y,fali)">invlink</a>	inverse link function for locfit.</li><li><a href="lfmarg.html" class="code" title="function xfit = lfmarg(fit)">lfmarg</a>	computes grid margins from a locfit object, used for plotting.</li><li><a href="plotbyfactor.html" class="code" title="function plotbyfactor(x,y,f)">plotbyfactor</a>	helper function</li><li><a href="predict.html" class="code" title="function [y, se] = predict(varargin)">predict</a>	Interpolate a fit produced by locfit().</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="../../chronux_1_50/helper/den_jack.html" class="code" title="function [m,ll,ul,llj,ulj]=den_jack(X,family,varargin)">den_jack</a>	Function to compute smooth estimates of the mean of x using locfit,</li><li><a href="../../chronux_1_50/locfit/Book/fig11_4.html" class="code" title="">fig11_4</a>	Local Regression and Likelihood, Figure 11.4.</li><li><a href="../../chronux_1_50/locfit/Book/fig11_5.html" class="code" title="">fig11_5</a>	Local Regression and Likelihood, Figure 11.5.</li><li><a href="../../chronux_1_50/locfit/Book/fig2_2.html" class="code" title="">fig2_2</a>	Local Regression and Likelihood, Figure 2.2.</li><li><a href="../../chronux_1_50/locfit/Book/fig2_3.html" class="code" title="">fig2_3</a>	Local Regression and Likelihood, Figure 2.3.</li><li><a href="../../chronux_1_50/locfit/Book/fig2_4.html" class="code" title="">fig2_4</a>	Local Regression and Likelihood, Figure 3.1.</li><li><a href="../../chronux_1_50/locfit/Book/fig2_5.html" class="code" title="">fig2_5</a>	Local Regression and Likelihood, Figure 2.3.</li><li><a href="../../chronux_1_50/locfit/Book/fig3_1.html" class="code" title="">fig3_1</a>	Local Regression and Likelihood, Figure 3.1.</li><li><a href="../../chronux_1_50/locfit/Book/fig4_1.html" class="code" title="">fig4_1</a>	Local Regression and Likelihood, Figure 4.1.</li><li><a href="../../chronux_1_50/locfit/Book/fig4_2.html" class="code" title="">fig4_2</a>	Local Regression and Likelihood, Figure 4.2.</li><li><a href="../../chronux_1_50/locfit/Book/fig5_1.html" class="code" title="">fig5_1</a>	Local Regression and Likelihood, Figure 5.1.</li><li><a href="../../chronux_1_50/locfit/Book/fig5_2.html" class="code" title="">fig5_2</a>	Local Regression and Likelihood, Figure 5.2.</li><li><a href="../../chronux_1_50/locfit/Book/fig5_3.html" class="code" title="">fig5_3</a>	Local Regression and Likelihood, Figure 5.3.</li><li><a href="../../chronux_1_50/locfit/Book/fig5_4.html" class="code" title="">fig5_4</a>	Local Regression and Likelihood, Figure 5.4.</li><li><a href="../../chronux_1_50/locfit/Book/fig6_2.html" class="code" title="">fig6_2</a>	Local Regression and Likelihood, Figure 6.2.</li><li><a href="../../chronux_1_50/locfit/Book/fig6_3.html" class="code" title="">fig6_3</a>	Local Regression and Likelihood, Figure 6.3.</li><li><a href="../../chronux_1_50/locfit/Book/fig6_5.html" class="code" title="">fig6_5</a>	Local Regression and Likelihood, Figure 6.5.</li><li><a href="../../chronux_1_50/locfit/Book/fig6_7.html" class="code" title="">fig6_7</a>	Local Regression and Likelihood, Figure 6.6.</li><li><a href="../../chronux_1_50/locfit/Book/fig7_1.html" class="code" title="">fig7_1</a>	Local Regression and Likelihood, Figure 7.1.</li><li><a href="../../chronux_1_50/locfit/Book/fig7_2.html" class="code" title="">fig7_2</a>	Local Regression and Likelihood, Figure 7.2.</li><li><a href="../../chronux_1_50/locfit/Book/fig7_3.html" class="code" title="">fig7_3</a>	Local Regression and Likelihood, Figure 7.3.</li><li><a href="../../chronux_1_50/locfit/Book/fig7_4.html" class="code" title="">fig7_4</a>	Local Regression and Likelihood, Figure 7.4.</li><li><a href="../../chronux_1_50/locfit/Book/fig8_1.html" class="code" title="">fig8_1</a>	Local Regression and Likelihood, Figure 8.1.</li><li><a href="../../chronux_1_50/locfit/Book/fig8_3.html" class="code" title="">fig8_3</a>	Local Regression and Likelihood, Figure 8.3.</li><li><a href="../../chronux_1_50/locfit/Book/fig9_2.html" class="code" title="">fig9_2</a>	Local Regression and Likelihood, Figure 9.2.</li><li><a href="../../chronux_1_50/locfit/Neuro/lfex1.html" class="code" title="">lfex1</a>	Local Estimation a spike firing rate (in spikes per unit time).</li><li><a href="../../chronux_1_50/locfit/Neuro/lfex2.html" class="code" title="">lfex2</a>	Model the success probability of successive trials of a monkey</li><li><a href="lfgui.html" class="code" title="function varargout = lfgui(varargin)">lfgui</a>	LFGUI M-file for lfgui.fig</li><li><a href="scb.html" class="code" title="function z=scb(x,y,varargin)">scb</a>	Simultaneous Confidence Bands</li></ul>
<!-- crossreference -->


<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function lfplot(varargin)</a>
0002 <span class="comment">% Plot (for one or two dimensions) a locfit() fit.</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% Usage:</span>
0005 <span class="comment">%   fit = locfit(x,y);</span>
0006 <span class="comment">%   lfplot(fit);</span>
0007 <span class="comment">%</span>
0008 <span class="comment">% Plot the fitted smooth curve, and add a scatterplot of the data.</span>
0009 <span class="comment">%</span>
0010 <span class="comment">% Required argument:</span>
0011 <span class="comment">%   fit  (produced by locfit()).</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% Optional arguments:</span>
0014 <span class="comment">%   'nodata'  - don't add data to plot.</span>
0015 <span class="comment">%   'contour' - for 2-d predictors, use contour instead of surf.</span>
0016 <span class="comment">%   'direct'  - fit directly, instead of using interpolation</span>
0017 <span class="comment">%               (see the predict() function).</span>
0018 <span class="comment">%</span>
0019 <span class="comment">% To add confidence bands, use the lfband() function.</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% Author: Catherine Loader.</span>
0022 
0023 fit = varargin{1};
0024 data = fit{1};
0025 xdata = data{1};
0026 n = size(xdata,1);
0027 d = size(xdata,2);
0028 fali = fit{4}{5};
0029 ydata = data{2};
0030 wdata = data{3};
0031 cdata = data{4};
0032 <span class="keyword">if</span> length(cdata)==1 ; cdata = zeros(n,1); <span class="keyword">end</span>;
0033 showdata = (fit{2}{8}==0);
0034 ppargs = {};
0035 
0036 type = <span class="string">'s'</span>;
0037 na = 2;
0038 <span class="keyword">while</span> na &lt;= length(varargin)
0039   inc = 0;
0040   <span class="keyword">if</span> (strcmp(varargin{na},<span class="string">'contour'</span>))
0041     type = <span class="string">'c'</span>;
0042     inc = 1;
0043   <span class="keyword">end</span>;
0044   <span class="keyword">if</span> (strcmp(varargin{na},<span class="string">'nodata'</span>))
0045     showdata = 0;
0046     inc = 1;
0047   <span class="keyword">end</span>;
0048   <span class="keyword">if</span> (strcmp(varargin{na},<span class="string">'direct'</span>))
0049     ppargs = {ppargs{:} <span class="string">'direct'</span>};
0050     inc = 1;
0051   <span class="keyword">end</span>;
0052   <span class="keyword">if</span> (inc==0)
0053     error(<span class="string">'Unknown Input'</span>,varargin{na});
0054   <span class="keyword">end</span>;
0055   na = na+inc;
0056 <span class="keyword">end</span>;
0057 
0058 xfit = <a href="lfmarg.html" class="code" title="function xfit = lfmarg(fit)">lfmarg</a>(fit);
0059 yfit = <a href="predict.html" class="code" title="function [y, se] = predict(varargin)">predict</a>(fit,xfit,ppargs{:});
0060 yfit = <a href="invlink.html" class="code" title="function y0 = invlink(y,fali)">invlink</a>(yfit,fali);
0061 fam = mod(fali(1),64);
0062 <span class="keyword">if</span> (fam&gt;4)
0063   ydata = ydata ./ wdata;
0064 <span class="keyword">end</span>;
0065 
0066 <span class="keyword">if</span> (d==1)
0067   plot(xfit{1},yfit);
0068   <span class="keyword">if</span> (showdata)
0069     hold on;
0070      <span class="keyword">if</span> (length(ydata)==1); ydata = zeros(n,1); <span class="keyword">end</span>;
0071 
0072     <a href="plotbyfactor.html" class="code" title="function plotbyfactor(x,y,f)">plotbyfactor</a>(xdata,ydata,cdata);
0073     hold off;
0074     <span class="keyword">end</span>;
0075 <span class="keyword">end</span>;
0076 
0077 <span class="keyword">if</span> (d==2)
0078   x1 = xfit{1};
0079   x2 = xfit{2};
0080   yfit = reshape(yfit,length(x1),length(x2));
0081   <span class="keyword">if</span> (type==<span class="string">'c'</span>)
0082     [C h] = contour(x1,x2,yfit');
0083     clabel(C,h);
0084     <span class="keyword">if</span> (showdata)
0085       hold on;
0086       <a href="plotbyfactor.html" class="code" title="function plotbyfactor(x,y,f)">plotbyfactor</a>(xdata(:,1),xdata(:,2),cdata);
0087       hold off;
0088     <span class="keyword">end</span>;
0089   <span class="keyword">else</span>
0090     surf(x1,x2,yfit');
0091   <span class="keyword">end</span>;
0092 <span class="keyword">end</span>;
0093 
0094 <span class="keyword">return</span>;</pre></div>
<hr><address>Generated on Mon 09-Oct-2006 00:54:52 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/">m2html</a></strong> &copy; 2003</address>
</body>
</html>